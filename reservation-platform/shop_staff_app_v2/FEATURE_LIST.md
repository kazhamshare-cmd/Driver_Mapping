# shop_staff_app_v2 機能一覧

## 概要

このドキュメントは、WEBダッシュボード（shop-dashboard）の全機能と、shop_staff_app_v2への実装状況をまとめたものです。
目標：**店舗オーナー・店長・スタッフがWEBなしでアプリのみで運営できる状態**

---

## 1. 実装済み機能

### A. 認証・ユーザー管理
| 機能 | 状態 | 備考 |
|------|------|------|
| ログイン | ✅ 完了 | メール/パスワード認証 |
| ログアウト | ✅ 完了 | |
| 権限管理（Owner/Manager/Staff） | ✅ 完了 | auth_provider.dart |
| モード切替（営業/管理） | ✅ 完了 | オーナー・店長のみ |

### B. 日常営業機能
| 機能 | 状態 | 備考 |
|------|------|------|
| 代理注文 | ✅ 完了 | テーブル選択→商品選択 |
| レジ・会計 | ✅ 完了 | 複数支払方法対応 |
| 注文管理 | ✅ 完了 | ステータス管理、印刷 |
| テーブル管理 | ✅ 完了 | QRコード表示含む |
| 出退勤 | ✅ 完了 | 打刻機能 |
| 予約管理 | ✅ 完了 | 一覧・ステータス管理 |
| 掲示板 | ✅ 完了 | スタッフ間連絡 |

### C. 管理機能（オーナー・店長）
| 機能 | 状態 | 備考 |
|------|------|------|
| スタッフ管理 | ✅ 完了 | 登録・編集・権限設定 |
| シフト管理 | ✅ 完了 | 週間表示・変更申請 |
| 勤怠管理 | ✅ 完了 | 時間修正機能 |
| 商品管理（基本） | ✅ 完了 | 価格変更、在庫切れ |
| 売上分析 | ✅ 完了 | 日別/週別/月別 |
| 顧客管理 | ✅ 完了 | 検索、ブラックリスト |
| 店舗設定（基本） | ✅ 完了 | 基本情報、営業設定 |
| キャンセル・削除履歴 | ✅ 完了 | オーナー専用 |
| 注文削除 | ✅ 完了 | オーナー専用 |

### D. その他
| 機能 | 状態 | 備考 |
|------|------|------|
| プリンター設定 | ✅ 完了 | Bluetooth/WiFi |
| 通知設定 | ✅ 完了 | 通知音等 |
| 言語設定 | ✅ 完了 | 日本語/英語/タイ語 |
| FCMプッシュ通知 | ✅ 完了 | 新規注文通知 |

---

## 2. 未実装機能（WEBのみ）

### A. 商品管理（詳細）
| 機能 | 優先度 | 説明 |
|------|--------|------|
| カテゴリ管理 | 高 | カテゴリの追加・編集・削除・並び替え |
| オプション管理 | 高 | トッピング等のオプション設定 |
| 商品画像アップロード | 高 | 商品写真の登録・変更 |
| 商品並び替え | 中 | ドラッグ&ドロップで順序変更 |
| 多言語翻訳 | 中 | 商品名・説明の多言語入力 |
| 商品一括登録/CSV | 低 | CSVインポート/エクスポート |

### B. 予約管理（詳細）
| 機能 | 優先度 | 説明 |
|------|--------|------|
| カレンダー表示 | 高 | 月間/週間カレンダービュー |
| 予約ブロック | 中 | 特定時間帯の予約停止 |
| 予約QRコード生成 | 中 | 顧客用予約ページQR |
| 手動予約作成 | 中 | ウォークイン対応 |

### C. 分析・レポート（詳細）
| 機能 | 優先度 | 説明 |
|------|--------|------|
| スタッフ別売上 | 高 | 担当者別の売上分析 |
| 顧客分析 | 中 | リピート率、VIP識別 |
| CSV/PDFエクスポート | 中 | レポート出力 |
| 言語別分析 | 低 | 顧客の使用言語分析 |

### D. 店舗設定（詳細）
| 機能 | 優先度 | 説明 |
|------|--------|------|
| 営業時間設定 | 高 | 曜日別の営業時間 |
| 営業カレンダー | 高 | 休日・特別営業日設定 |
| 店舗ロゴ・画像 | 中 | ロゴのアップロード |
| ウェルカムメッセージ | 低 | 顧客向けメッセージ編集 |
| お知らせ管理 | 低 | 店舗からのお知らせ |

### E. 決済設定
| 機能 | 優先度 | 説明 |
|------|--------|------|
| 支払方法設定 | 高 | 有効/無効の切り替え |
| Stripe Connect設定 | 中 | カード決済連携 |
| Omise設定（タイ向け） | 中 | タイ向け決済連携 |

### F. LINE連携
| 機能 | 優先度 | 説明 |
|------|--------|------|
| LINE API設定 | 中 | Channel設定 |
| 通知設定 | 中 | 予約確認、リマインダー |
| 管理者通知 | 中 | 管理者へのLINE通知 |

### G. その他
| 機能 | 優先度 | 説明 |
|------|--------|------|
| バック承認 | 高 | 注文取消の承認機能 |
| プラン管理 | 中 | サブスクリプション確認 |
| シフトGantt表示 | 低 | 詳細なシフト可視化 |

---

## 3. 実装計画

### Phase 1: 高優先度（必須機能）✅ 完了
1. [x] カテゴリ管理画面（ドラッグ&ドロップ並び替え対応）
2. [x] オプション管理画面（選択肢・多言語対応）
3. [x] 商品画像アップロード（圧縮・動画対応）
4. [x] 営業時間設定（曜日別・ラストオーダー）
5. [x] 営業カレンダー（特別営業日・臨時休業日）
6. [x] 予約カレンダー表示（月間/週間・ガントチャート）
7. [x] 支払方法設定（18種類の決済方法対応）
8. [x] バック承認機能（申請・承認・却下）
9. [x] スタッフ別売上分析（ランキング表示）

### Phase 2: 中優先度
10. [ ] 商品並び替え
11. [ ] 多言語翻訳入力
12. [ ] 予約ブロック機能
13. [ ] 手動予約作成
14. [ ] 顧客詳細分析
15. [ ] CSV/PDFエクスポート
16. [ ] 店舗ロゴアップロード
17. [ ] LINE連携設定
18. [ ] Stripe/Omise設定
19. [ ] プラン確認画面

### Phase 3: 低優先度
20. [ ] 商品CSV一括登録
21. [ ] 言語別分析
22. [ ] ウェルカムメッセージ編集
23. [ ] お知らせ管理
24. [ ] シフトGantt表示

---

## 4. 技術メモ

### WEBダッシュボードで使用している主要技術
- React + TypeScript
- Material-UI (MUI)
- Recharts（グラフ）
- FullCalendar（カレンダー）
- React DnD（ドラッグ&ドロップ）
- Firebase SDK

### アプリで対応するパッケージ
- `flutter_riverpod` - 状態管理
- `cloud_firestore` - データベース
- `firebase_storage` - 画像アップロード
- `image_picker` - 画像選択
- `table_calendar` - カレンダー表示
- `fl_chart` - グラフ表示
- `reorderable_list` - 並び替え

---

## 5. Firestoreコレクション構造

### 主要コレクション
```
shops/
  {shopId}/
    categories/      # 商品カテゴリ
    products/        # 商品
    options/         # オプション
    tables/          # テーブル
    orders/          # 注文（※トップレベルにもある）
    customers/       # 顧客
    employees/       # スタッフ
    shifts/          # シフト
    attendances/     # 勤怠
    reservations/    # 予約
    bulletinPosts/   # 掲示板
    deletedOrders/   # 削除された注文ログ

orders/              # 注文（トップレベル）
  {orderId}/

users/               # ユーザー認証情報
  {userId}/
```

---

## 6. 権限マトリックス

| 機能 | オーナー | 店長 | スタッフ |
|------|:--------:|:----:|:--------:|
| 日常営業（注文・会計） | ○ | ○ | ○ |
| 予約確認 | ○ | ○ | ○ |
| シフト確認 | ○ | ○ | ○ |
| 出退勤打刻 | ○ | ○ | ○ |
| 商品管理 | ○ | ○ | × |
| シフト管理 | ○ | ○ | × |
| 勤怠修正 | ○ | ○ | × |
| 売上分析 | ○ | ○（閲覧） | × |
| スタッフ管理 | ○ | × | × |
| 店舗設定 | ○ | × | × |
| 注文削除 | ○ | × | × |
| キャンセル履歴 | ○ | × | × |
| ブラックリスト | ○ | × | × |

---

## 更新履歴

- 2025/12/24: Phase 1 完了
  - カテゴリ管理画面（並び替え機能追加）
  - オプション管理画面（確認済み）
  - 商品画像アップロード（確認済み）
  - 営業時間設定（曜日別営業時間ダイアログ追加）
  - 営業カレンダー（特別営業日・臨時休業日画面追加）
  - 予約カレンダー（確認済み）
  - 支払方法設定（18種類の決済方法画面追加）
  - バック承認機能（申請モデル・プロバイダー・承認画面追加）
  - スタッフ別売上分析（分析画面にタブ追加）

- 2025/12/24: 初版作成
  - WEBダッシュボード機能調査完了
  - 実装済み/未実装の分類
  - 実装計画策定
